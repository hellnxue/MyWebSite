<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>无标题文档</title>
<script>


function testNumber(which){
     
	 if(/^\d+$/.test(which.value)==false){
	     console.log("只能填数字！");
	     // which.value=which.value.replace(/^\d+$/g,'');
       which.value=which.value.replace(/[^\d]/g,'');
       
       console.log(which.value)
	 }
}

//验证数字（只能是数字）
  function test(which){

	  if (which.value.length<=17) {

	  	which.value=which.value.replace(/[^0-9]/g,'');  
	  	console.log('1')
	  }else  if(which.value.length==18 ) {

	  	var ary=which.value.split('');
	  	// console.log(ary+'');
	  	var arys=ary.map(function(item,index){
           if (index==17) {
             item=item.replace(/[^0-9xX]/g,'');
             if (item=='x') {
             	item=item.toUpperCase();
             }
           }else{
           	  item=item.replace(/[^0-9]/g,'');
           }

           return item;

        }) 

       console.log(arys+'');

       which.value=arys.join('')

	  }


  }
</script>
</head>

<body>
<label>18位身份证，最后一位允许输入x，其它全部必须是数字，包括15位的（15位的身份证也必须是数字）</label>
<input type="text" name="integer" value="" id="dd"  onkeyup="test(this)" maxlength="18" />


<label>验证只能输入数字</label>
<input type="text" name="integer" value="" id="dd"  onkeyup="testNumber(this)"  />

<div>&nbsp;</div>
</body>
</html>
