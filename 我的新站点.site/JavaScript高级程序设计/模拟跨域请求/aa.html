<!DOCTYPE html  >
<html >
<head>
<meta  charset="utf-8" />
<title>localhost和127.0.0.1模拟跨域信息传递</title>
<style>
  h3{ 
   	font-size: 30px;
	color: pink;

	}
   
</style>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head>

<body>
<iframe id="iframe" src="http://127.0.0.1:8081/bb.html" style="display:none;"></iframe>
<h3 class="h1">hello aa.html  用http://localhost:8081访问页面，测试跨域信息请求
	<p>domain1:http://localhost:8081</p>
	<p>domain2:http://127.0.0.1:8081</p>
</h3>
<script>       
    var iframe = document.getElementById('iframe');
    iframe.onload = function() {
        var data = {
            name: 'aym'
        };
        // 向domain2传送跨域数据
        iframe.contentWindow.postMessage(JSON.stringify(data), 'http://127.0.0.1:8081');
    };

    // 接受domain2返回数据
    window.addEventListener('message', function(e) {
		console.log('ee');
		console.log(e);
		//判断来源，安全策略
		if(e.origin!=='http://127.0.0.1:8081'){
			return;
		}
        console.log('data from 127.0.0.1 ---> ' + e.data);
    }, false);
</script> 
</body>
</html>
